var ViewTicketModal=React.createClass({displayName:"ViewTicketModal",getInitialState:function(){return{viewTicketData:[],viewTicketMainData:{},uniqedata:[],isEdit:!1}},componentWillMount:function(){var a=this;this.serverRequest=$.get(baseurl+"play/game2/"+userId+","+sessionId+","+this.props.plsid,function(b){"object"!=typeof b&&(b=JSON.parse(b));var c=b.items,d=[],e=[];for(i=0;i<c.length;i++)e.indexOf(c[i].evi_id)===-1?(c[i].isStar=!1,c[i].answer=" ",c[i].picValues=[],c[i].picValues.push({pic_value1:c[i].pic_value1,pic_value2:c[i].pic_value2,pic_id:c[i].pic_id}),d.push(c[i]),e.push(c[i].evi_id)):d[e.indexOf(c[i].evi_id)].picValues.push({pic_value1:c[i].pic_value1,pic_value2:c[i].pic_value2,pic_id:c[i].pic_id});for(j=0;j<d.length;j++)for(d[j].picValues.sort(function(a,b){return parseFloat(a.pic_value1)-parseFloat(b.pic_value1)}),d[j].values=[],k=0;k<d[j].picValues.length;k++)d[j].values.push(d[j].picValues[k].pic_value2);uniqedata=d,this.setState({uniqedata:d}),this.serverRequest=$.get(baseurl+"play/review/"+userId+","+sessionId+","+this.props.ticket,function(b){"object"!=typeof b&&(b=JSON.parse(b));var c=b.items,d=c[0];d.ticket_no=c[1].ticket_no;var e=d.timestamp,f=e,g=f.slice(0,4),h=f.slice(4,6),j=f.slice(6,8),k=f.slice(8,10),l=f.slice(10,12),m=f.slice(12,14),n=g+"/"+h+"/"+j+" at  "+k+":"+l+":"+m,o=a.state.uniqedata;for(i=0;i<o.length;i++){var p=c.filter(function(a){if(o[i].evi_number==a.event_order)return!0});p.length>0&&(o[i].answer=p[0].valuex,o[i].isStar="Y"==p[0].star)}a.setState({viewTicketData:c,viewTicketMainData:d,formatedDate:n,uniqedata:o})}.bind(this))}.bind(this))},editTicket:function(){this.setState({isEdit:!0});var a=this;setTimeout(function(){var b=a.state.uniqedata,c=b.filter(function(a){if(a.isStar)return!0});c.length>0&&$("#OptdropQuestar1").val(c[0].evi_id)},100)},componentDidMount:function(){$(ReactDOM.findDOMNode(this)).modal("show"),$(ReactDOM.findDOMNode(this)).on("hidden.bs.modal",this.props.handleHideViewTicket)},submitQuestions:function(){var a=[],b=this.state.uniqedata,c={};for(i=0;i<b.length;i++)if(""==b[i].answer||null==b[i].answer||"No Answer"==b[i].answer)return $("#EditError").html("Please answer all the questions and choose star question"),!1;for($("#EditError").html(""),i=0;i<b.length;i++)c.upl_id=this.props.ticket,c.evi_id=b[i].evi_id,c.pic_id=b[i].pic_id,c.pic_no="No Answer"==b[i].answer?"":b[i].answer,b[i].isStar?c.star="Y":c.star="N",a[i]=c,c={};this.serverRequest=$.post(baseurl+"play/update/"+userId+","+sessionId,JSON.stringify({items:a}),function(a){$("#ViewTicketModal").modal("hide")}),$("#BuyTicketModal").modal("hide")},render:function(){var a=this;return React.createElement("div",{className:"modal fade animated fadeIn",id:"ViewTicketModal",tabIndex:"-2",role:"dialog","aria-labelledby":"myModalLabel","data-keyboard":"true"},React.createElement("div",{className:"modal-dialog ",role:"document"},React.createElement("div",{className:"modal-content BuyTicketModal"},React.createElement("div",{className:"modal-header"},React.createElement("img",{src:"/images/close-icon.svg","data-dismiss":"modal",className:"pointer-hand pull-right ",width:"25"}),React.createElement("br",null)),React.createElement("div",{className:"modal-body no-padding"},React.createElement("div",{className:"bg-blue row no-margin"},React.createElement("h3",{className:""},"Ticket #",this.state.viewTicketMainData.ticket_no)),React.createElement("div",{className:"space-5"}),React.createElement("div",null,this.state.uniqedata.map(function(b,c){var d=c+"_3";return c%2==0?React.createElement("div",{className:b.isStar?"selected-star-qn game-qns-box padding-10 bg-light-blue margin-10":"game-qns-box padding-10 bg-light-blue margin-10",key:c},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-lg-8 col-md-8 col-sm-8 col-xs-7"},React.createElement("span",{className:"game-question"},b.evi_desc)),React.createElement("div",{className:"col-lg-4 col-md-4 col-sm-4 col-xs-5 text-right"},a.state.isEdit?React.createElement(OptdropEdit,{val:b.values,self:a,data:a.state.uniqedata,ind:c,ids:d,queType:b.evi_ui_type,ans:b.answer}):React.createElement("div",{className:"bg-dark-blue answer"},"1-90"==b.valuex?b.answer:"N"==b.answer?"No":"Y"==b.answer?"Yes":b.answer)))):React.createElement("div",{className:b.isStar?"selected-star-qn game-qns-box padding-10 bg-dark-blue margin-10":"game-qns-box padding-10 bg-dark-blue margin-10",key:c},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-lg-8 col-md-8 col-sm-8 col-xs-7"},React.createElement("span",{className:"game-question"},b.evi_desc)),React.createElement("div",{className:"col-lg-4 col-md-4 col-sm-4 col-xs-5 text-right"},a.state.isEdit?React.createElement(OptdropEdit,{val:b.values,self:a,data:a.state.uniqedata,ind:c,ids:d,queType:b.evi_ui_type,ans:b.answer}):React.createElement("div",{className:"bg-light-blue answer"},"1-90"==b.valuex?b.valuex:"N"==b.answer?"No":"Y"==b.answer?"Yes":b.answer))))}),a.state.isEdit?React.createElement("div",{className:"game-qns-box bg-star-qn margin-10"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-lg-8 col-md-8 col-sm-8 col-xs-7"},React.createElement("span",{className:"game-question"},"Which of the questions do you want to double points for?")),React.createElement("div",{className:"col-lg-4 col-md-4 col-sm-4 col-xs-5 text-right"},React.createElement(OptdropQue,{self:a,data:a.state.uniqedata,ind:"star1"})))):"",React.createElement("div",{id:"EditError",className:"text-center sm-txt"})),React.createElement("div",{className:"row no-margin"},React.createElement("div",{className:"col-lg-12 text-center"},React.createElement("div",{className:"space-5"}),React.createElement("h4",null,"Ticket ref #",this.props.ticket," purchased for Â£ ",this.state.viewTicketMainData.entry_," ",React.createElement("span",{className:"d-block-m"},"on ",this.state.formatedDate)),React.createElement("div",{className:"space-5"}))),React.createElement("div",{className:"col-lg-4 col-md-4 col-sm-4 col-xs-8 col-centered"},"O"==this.props.gamestatus?a.state.isEdit?React.createElement("button",{className:"btn zoola-btn",onClick:this.submitQuestions},React.createElement("h5",{className:""},"Update Ticket")):React.createElement("button",{className:"btn zoola-btn",onClick:this.editTicket},React.createElement("h5",{className:"",onClick:this.editTicket},"Edit Ticket")):"",React.createElement("div",{className:"space-10"}))),React.createElement("div",{className:"modal-footer"},React.createElement("p",{className:"ntr-txt text-center underline","data-dismiss":"modal"},"Close")))))}});